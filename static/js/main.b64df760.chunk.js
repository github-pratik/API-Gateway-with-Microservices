(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(7),c=a.n(r),o=a(4),s=a(1);const m="https://apigatewaywithmicroservice.vercel.app",i=()=>{const e=localStorage.getItem("token");return{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}},u=async e=>{try{console.log("Making login request to:","".concat(m,"/auth/token"));const a=await fetch("".concat(m,"/auth/token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e})}),n=await a.json();if(console.log("Login response:",n),!a.ok)throw new Error(n.error||"Login failed");return n}catch(t){throw console.error("Login error details:",t),t}},d=async()=>{return(await fetch("".concat(m,"/products/products"),{headers:i()})).json()},E=async e=>{return(await fetch("".concat(m,"/products/products"),{method:"POST",headers:i(),body:JSON.stringify(e)})).json()},p=async()=>{return(await fetch("".concat(m,"/orders/orders"),{headers:i()})).json()},b=async e=>{return(await fetch("".concat(m,"/orders/orders"),{method:"POST",headers:i(),body:JSON.stringify(e)})).json()},h=async()=>{return(await fetch("".concat(m,"/users/users"),{headers:i()})).json()};var v=function(e){let{onLogin:t}=e;const[a,r]=Object(n.useState)("");return l.a.createElement("div",{className:"card p-4 mx-auto",style:{maxWidth:"400px"}},l.a.createElement("h2",{className:"text-center mb-4"},"Login"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault();try{console.log("Attempting login with:",a);const{token:e}=await u(a);console.log("Login successful, token:",e),t(e)}catch(n){console.error("Login failed:",n),alert("Login failed")}}},l.a.createElement("div",{className:"mb-3"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Username",value:a,onChange:e=>r(e.target.value)})),l.a.createElement("button",{type:"submit",className:"btn btn-primary w-100"},"Login")))},y=a(3);var g=function(){const[e,t]=Object(n.useState)([]),[a,r]=Object(n.useState)({name:"",description:"",price:"",stock:""});Object(n.useEffect)(()=>{c()},[]);const c=async()=>{try{const a=await d();t(a)}catch(e){alert("Failed to load products")}};return l.a.createElement("div",null,l.a.createElement("h2",null,"Products"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-8"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Name"),l.a.createElement("th",null,"Description"),l.a.createElement("th",null,"Price"),l.a.createElement("th",null,"Stock"))),l.a.createElement("tbody",null,e.map(e=>l.a.createElement("tr",{key:e.id},l.a.createElement("td",null,e.name),l.a.createElement("td",null,e.description),l.a.createElement("td",null,"$",e.price),l.a.createElement("td",null,e.stock)))))),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("form",{onSubmit:async e=>{e.preventDefault();try{await E(a),c(),r({name:"",description:"",price:"",stock:""})}catch(t){alert("Failed to create product")}}},l.a.createElement("h4",null,"Add New Product"),l.a.createElement("div",{className:"mb-3"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Name",value:a.name,onChange:e=>r(Object(y.a)(Object(y.a)({},a),{},{name:e.target.value}))})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Description",value:a.description,onChange:e=>r(Object(y.a)(Object(y.a)({},a),{},{description:e.target.value}))})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("input",{type:"number",className:"form-control",placeholder:"Price",value:a.price,onChange:e=>r(Object(y.a)(Object(y.a)({},a),{},{price:e.target.value}))})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("input",{type:"number",className:"form-control",placeholder:"Stock",value:a.stock,onChange:e=>r(Object(y.a)(Object(y.a)({},a),{},{stock:e.target.value}))})),l.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Add Product")))))};var N=function(){const[e,t]=Object(n.useState)([]),[a,r]=Object(n.useState)([]),[c,o]=Object(n.useState)({product_id:"",quantity:1});Object(n.useEffect)(()=>{s(),m()},[]);const s=async()=>{try{const a=await p();t(a)}catch(e){alert("Failed to load orders")}},m=async()=>{try{const t=await d();r(t)}catch(e){alert("Failed to load products")}};return l.a.createElement("div",null,l.a.createElement("h2",null,"Orders"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-8"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Order ID"),l.a.createElement("th",null,"Total Amount"),l.a.createElement("th",null,"Status"),l.a.createElement("th",null,"Created At"))),l.a.createElement("tbody",null,e.map(e=>l.a.createElement("tr",{key:e.id},l.a.createElement("td",null,e.id),l.a.createElement("td",null,"$",e.total_amount),l.a.createElement("td",null,e.status),l.a.createElement("td",null,new Date(e.created_at).toLocaleString())))))),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("form",{onSubmit:async e=>{e.preventDefault();try{const e=a.find(e=>e.id===parseInt(c.product_id));await b({user_id:1,items:[{product_id:parseInt(c.product_id),quantity:parseInt(c.quantity),price:e.price}]}),s(),o({product_id:"",quantity:1})}catch(t){alert("Failed to create order")}}},l.a.createElement("h4",null,"Create New Order"),l.a.createElement("div",{className:"mb-3"},l.a.createElement("select",{className:"form-control",value:c.product_id,onChange:e=>o(Object(y.a)(Object(y.a)({},c),{},{product_id:e.target.value}))},l.a.createElement("option",{value:""},"Select Product"),a.map(e=>l.a.createElement("option",{key:e.id,value:e.id},e.name," - $",e.price)))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("input",{type:"number",className:"form-control",placeholder:"Quantity",min:"1",value:c.quantity,onChange:e=>o(Object(y.a)(Object(y.a)({},c),{},{quantity:e.target.value}))})),l.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Create Order")))))};var f=function(){const[e,t]=Object(n.useState)([]);Object(n.useEffect)(()=>{a()},[]);const a=async()=>{try{const a=await h();t(a)}catch(e){alert("Failed to load users")}};return l.a.createElement("div",null,l.a.createElement("h2",null,"Users"),l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"ID"),l.a.createElement("th",null,"Username"),l.a.createElement("th",null,"Email"),l.a.createElement("th",null,"Created At"))),l.a.createElement("tbody",null,e.map(e=>l.a.createElement("tr",{key:e.id},l.a.createElement("td",null,e.id),l.a.createElement("td",null,e.username),l.a.createElement("td",null,e.email),l.a.createElement("td",null,new Date(e.created_at).toLocaleString())))))))};var O=function(){const e=Object(s.q)();return l.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},l.a.createElement("div",{className:"container"},l.a.createElement(o.b,{className:"navbar-brand",to:"/"},"Microservices Demo"),l.a.createElement("div",{className:"navbar-nav"},l.a.createElement(o.b,{className:"nav-link",to:"/products"},"Products"),l.a.createElement(o.b,{className:"nav-link",to:"/orders"},"Orders"),l.a.createElement(o.b,{className:"nav-link",to:"/users"},"Users"),l.a.createElement("button",{className:"btn btn-outline-light ms-2",onClick:()=>{localStorage.removeItem("token"),e("/login")}},"Logout"))))};var w=function(){const[e,t]=Object(n.useState)(localStorage.getItem("token"));return l.a.createElement(o.a,null,e&&l.a.createElement(O,null),l.a.createElement("div",{className:"container mt-4"},l.a.createElement(s.d,null,l.a.createElement(s.b,{path:"/login",element:e?l.a.createElement(s.a,{to:"/products"}):l.a.createElement(v,{onLogin:e=>{localStorage.setItem("token",e),t(e)}})}),l.a.createElement(s.b,{path:"/products",element:e?l.a.createElement(g,null):l.a.createElement(s.a,{to:"/login"})}),l.a.createElement(s.b,{path:"/orders",element:e?l.a.createElement(N,null):l.a.createElement(s.a,{to:"/login"})}),l.a.createElement(s.b,{path:"/users",element:e?l.a.createElement(f,null):l.a.createElement(s.a,{to:"/login"})}),l.a.createElement(s.b,{path:"/",element:l.a.createElement(s.a,{to:"/login"})}))))};a(16);c.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(w,null)))},8:function(e,t,a){e.exports=a(17)}},[[8,1,2]]]);
//# sourceMappingURL=main.b64df760.chunk.js.map